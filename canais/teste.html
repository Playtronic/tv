  document.addEventListener('keydown', function() {
                showControls();
                resetControlsTimer();
            });
        }
        
        function atualizarHora() {
            if (SHOW_TIME && timeDisplay) {
                const agora = new Date();
                const horas = agora.getHours().toString().padStart(2, '0');
                const minutos = agora.getMinutes().toString().padStart(2, '0');
                timeDisplay.textContent = \`\${horas}:\${minutos}\`;
            }
        }    function verificarFimDoVideo() {
        console.log('=== FIM DO VÍDEO DETECTADO ===');
        console.log('Estado atual:', currentState);
        console.log('Slot atual:', currentPlayingSlot);
        
        // SÓ TRATA PROGRAMAS - COMERCIAIS TEM HANDLER PRÓPRIO
        if (currentState === 'program') {
            console.log('Programa terminou. Verificando comerciais...');
            if (ENABLE_COMMERCIALS && TV_COMMERCIALS.length > 0) {
                commercialBreakCount = 0; // Resetar contador ANTES de começar
                console.log('Iniciando intervalo comercial...');
                reproduzirComercial();
            } else {
                console.log('Sem comerciais. Indo para próximo programa...');
                const proximoSlot = getNextSlot();
                reproduzirPrograma(proximoSlot, 0);
            }
        }
        // NÃO FAZ NADA PARA COMERCIAIS - eles têm seu próprio handler
    }
                      function verificarMudancaDeDia() {
            if (PROGRAMMING_MODE === 'grade') {
                const agora = new Date();
                const horas = agora.getHours();
                const minutos = agora.getMinutes();
                
                // Verificar se precisa recarregar entre 06:00 e 06:24
                verificarRecarregamentoGrade();
                

            }
        }
        
        function inicializarPlayer() {
