<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="utf-8">
<title>Gerador de TV Online</title>
<style>
body { font-family:Arial; background:#111; color:#fff; padding:20px; }
input, textarea { width:100%; margin-bottom:10px; padding:8px; }
button { padding:10px 20px; margin-top:10px; cursor:pointer; }
#log { margin-top:20px; background:#222; padding:10px; border-radius:5px; }
</style>
</head>
<body>

<h1>Gerador Autom√°tico de Canal de TV</h1>

<label>Nome da TV (apenas letras, n√∫meros e -):</label>
<input id="tvName" placeholder="ex: minha-tv">

<label>URLs dos v√≠deos (um por linha):</label>
<textarea id="videos" placeholder="https://youtu.be/abc123..."></textarea>

<button onclick="gerarTV()">Gerar TV</button>

<div id="log"></div>

<script>
const OWNER = "Playtronic";
const REPO = "tv";

function log(msg){
    let el = document.getElementById("log");
    el.innerHTML += msg + "<br>";
}

async function gerarTV(){
    document.getElementById("log").innerHTML = "";
    let tvName = document.getElementById("tvName").value.trim();
    let videos = document.getElementById("videos").value.trim().split(/\n+/).filter(x=>x.trim());

    if(!tvName.match(/^[a-zA-Z0-9-]+$/)){
        log("‚ùå Nome da TV inv√°lido.");
        return;
    }

    if(videos.length === 0){
        log("‚ùå Adicione pelo menos um v√≠deo.");
        return;
    }

    log("üì® Enviando pedido para gerar a TV...");

    let body = {
        tv_name: tvName,
        videos: videos
    };

    let issueData = {
        title: "Gerar TV: " + tvName,
        body: JSON.stringify(body, null, 2)
    };

    // Criar issue SEM TOKEN
    let res = await fetch(`https://api.github.com/repos/${OWNER}/${REPO}/issues`, {
        method: "POST",
        headers: { "Content-Type":"application/json" },
        body: JSON.stringify(issueData)
    });

    if(!res.ok){
        log("‚ùå Falha ao criar issue: " + res.status);
        return;
    }

    let json = await res.json();
    log("‚úÖ Pedido enviado! Issue #" + json.number);
    log("‚è≥ Aguarde ~30 segundos para a TV ser publicada...");

    // Exibir link futuro
    log(`üîó A TV ficar√° dispon√≠vel em:<br>
         https://${OWNER.toLowerCase()}.github.io/${REPO}/${tvName}/`);
}
</script>

</body>
</html>
